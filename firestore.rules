/**
 * @fileoverview Firestore Security Rules for the college canteen ordering system.
 *
 * Core Philosophy:
 * This ruleset allows any authenticated user to create, read, update, and delete all documents in the Firestore database.
 *
 * Data Structure:
 * The database consists of three top-level collections: `/menuItems/{menuItemId}`, `/orders/{orderId}`, and `/orderItems/{orderItemId}`.
 *
 * Key Security Decisions:
 * This ruleset allows unrestricted access to all data for any authenticated user.
 *
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Rules for the /menuItems collection. Allows any authenticated user to read, create, update, and delete menu items.
     * @path /menuItems/{menuItemId}
     * @allow (get, list) Any authenticated user can read any menu item.
     * @allow (create, update, delete) Any authenticated user can create, update, and delete menu items.
     * @deny (none) No requests are explicitly denied in this configuration.
     * @principle Allows any authenticated user full access to menu items.
     */
    match /menuItems/{menuItemId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Rules for the /orders collection. Allows any authenticated user to read, create, update, and delete orders.
     * @path /orders/{orderId}
     * @allow (get, list) Any authenticated user can read any order.
     * @allow (create, update, delete) Any authenticated user can create, update, and delete orders.
     * @deny (none) No requests are explicitly denied in this configuration.
     * @principle Allows any authenticated user full access to orders.
     */
    match /orders/{orderId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    /**
     * @description Rules for the /orderItems collection. Allows any authenticated user to read, create, update, and delete order items.
     * @path /orderItems/{orderItemId}
     * @allow (get, list) Any authenticated user can read any order item.
     * @allow (create, update, delete) Any authenticated user can create, update, and delete order items.
     * @deny (none) No requests are explicitly denied in this configuration.
     * @principle Allows any authenticated user full access to order items.
     */
    match /orderItems/{orderItemId} {
      allow get, list: if isSignedIn();
      allow create, update, delete: if isSignedIn();
    }

    // Helper function to determine if a user is signed in.
    function isSignedIn() {
      return request.auth != null;
    }
  }
}